# Google OAuth Setup Instructions

## Step 1: Create Google Cloud Project

1. Go to [Google Cloud Console](https://console.cloud.google.com/)
2. Create a new project or select existing one
3. Navigate to "APIs & Services" > "Credentials"

## Step 2: Enable Required APIs

1. Go to "APIs & Services" > "Library"
2. Enable these APIs:
   - **Google Calendar API**
   - **Google+ API** (for OAuth user info)

## Step 3: Create OAuth 2.0 Credentials

1. In "APIs & Services" > "Credentials"
2. Click "Create Credentials" > "OAuth 2.0 Client IDs"
3. Configure the OAuth consent screen if prompted:
   - Application type: Web application
   - Application name: Sidewalks
   - Authorized domains: sidewalkshq.com (for production)

4. For the OAuth 2.0 Client ID:
   - Application type: Web application
   - Name: Sidewalks Web App

   **Authorized JavaScript Origins:**

   Development: 

   ```
   http://localhost:3000
   https://localhost:3000
   ```

   Production:

   ```
   https://sidewalkshq.com
   ```

   **Authorized Redirect URIs:**

   Development: 
   ```
   http://localhost:3000/users/auth/google_oauth2/callback
   https://localhost:3000/users/auth/google_oauth2/callback
   ```

   Production:

   ```
   https://sidewalkshq.com/users/auth/google_oauth2/callback
   ```

   ⚠️ **Important**:
   - No trailing slashes on origins
   - Use `http://` for localhost, `https://` for production
   - The callback path `/users/auth/google_oauth2/callback` is generated by Devise + OmniAuth

## Step 4: Update Rails Credentials

1. Copy the Client ID and Client Secret from Google Console
2. Run: `EDITOR="code --wait" bin/rails credentials:edit`
3. Replace the fake credentials:

```yaml
google:
  client_id: YOUR_ACTUAL_CLIENT_ID_HERE
  client_secret: YOUR_ACTUAL_CLIENT_SECRET_HERE

secret_key_base: f97054934447f1305d25de39fb9ef5c6cab47cf4137dda3d6d71c74f179550d0a5eb8e294257f0c7aef190f6f7418a023befa4144698583f34db137959690a86
```

## Step 5: Test OAuth Flow

1. Start the Rails server: `bin/dev`
2. Visit: `http://localhost:3000/users/sign_in`
3. Click "Sign in with Google" link
4. Complete the OAuth flow

## Current Status

✅ **Fake credentials are set up** - the app will load but Google OAuth won't work until real credentials are added.

The fake credentials currently in use:
- Client ID: `fake_google_client_id_12345`
- Client Secret: `fake_google_client_secret_67890`

## Required OAuth Scopes

### Currently Configured:
```yaml
scope: "email,profile,https://www.googleapis.com/auth/calendar"
```

### Breakdown:
- **`email`** - User's email address (for account identification)
- **`profile`** - User's basic profile info (name, Google ID)
- **`https://www.googleapis.com/auth/calendar`** - Full calendar access

### What Full Calendar Access Allows:
- ✅ Read all calendars
- ✅ Create/update/delete events
- ✅ Access calendar metadata
- ✅ Manage multiple calendars
- ✅ Set event reminders and notifications

### Alternative Scopes (more restrictive):
- `https://www.googleapis.com/auth/calendar.readonly` - Read-only access
- `https://www.googleapis.com/auth/calendar.events` - Events only (no calendar management)

**Note**: Sidewalks requires full calendar access for the Activity Coordinator to create events when suggestions are accepted.

## Testing OAuth Flow

### Local Development:
1. Visit: `http://localhost:3000/users/sign_in`
2. Click "Sign in with Google"
3. Complete OAuth flow

### Production:
1. Visit: `https://sidewalkshq.com/users/sign_in`
2. Click "Sign in with Google"
3. Complete OAuth flow
